{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project%20React.js/TOTP/app/dashboard/page.tsx"],"sourcesContent":["'use client';\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Image from 'next/image';\r\n\r\nexport default function DashboardPage() {\r\n  const [user, setUser] = useState<any>(null);\r\n  const [qrCode, setQrCode] = useState('');\r\n  const [secret, setSecret] = useState('');\r\n  const [otp, setOtp] = useState('');\r\n  const [msg, setMsg] = useState('');\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const stored = localStorage.getItem('user');\r\n    if (!stored) {\r\n      router.push('/login');\r\n    } else {\r\n      setUser(JSON.parse(stored));\r\n    }\r\n  }, [router]);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('user');\r\n    router.push('/login');\r\n  };\r\n\r\n  const enable2FA = async () => {\r\n    const res = await fetch('/api/auth/2fa/generate', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ userId: user.id }),\r\n    });\r\n    const data = await res.json();\r\n    if (data.qrCode) {\r\n      setQrCode(data.qrCode);\r\n      setSecret(data.secret);\r\n      setMsg('Scan this QR Code with your Authenticator App');\r\n    }\r\n  };\r\n\r\n  const verify2FA = async () => {\r\n    const res = await fetch('/api/auth/2fa/verify', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ userId: user.id, token: otp }),\r\n    });\r\n    const data = await res.json();\r\n    if (data.success) {\r\n      setMsg('2FA Enabled Successfully!');\r\n      setQrCode('');\r\n      setSecret('');\r\n    } else {\r\n      setMsg('Invalid Code. Try again.');\r\n    }\r\n  };\r\n\r\n  if (!user) return <div className=\"p-10 text-center\">Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-8\">\r\n      <header className=\"flex justify-between items-center mb-8 max-w-4xl mx-auto\">\r\n        <h1 className=\"text-3xl font-bold text-gray-800\">Dashboard</h1>\r\n        <div className=\"flex items-center gap-4\">\r\n          <span className=\"text-gray-600\">User: <strong>{user.username}</strong></span>\r\n          <button \r\n            onClick={handleLogout}\r\n            className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition\"\r\n          >\r\n            Logout\r\n          </button>\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"max-w-4xl mx-auto space-y-6\">\r\n        <div className=\"bg-white p-6 rounded-lg shadow\">\r\n          <h2 className=\"text-xl font-semibold mb-4 text-blue-800\">Security Settings</h2>\r\n          \r\n          {!qrCode && !msg.includes('Successfully') ? (\r\n            <button \r\n              onClick={enable2FA}\r\n              className=\"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition\"\r\n            >\r\n              Setup 2FA (TOTP)\r\n            </button>\r\n          ) : null}\r\n\r\n          {qrCode && (\r\n            <div className=\"mt-6 border-t pt-6\">\r\n              <h3 className=\"text-lg font-medium mb-3\">Activator 2FA</h3>\r\n              <p className=\"mb-4 text-sm text-gray-600\">{msg}</p>\r\n              \r\n              <div className=\"flex flex-col md:flex-row gap-8 items-start\">\r\n                <div className=\"bg-white p-2 border rounded\">\r\n                  <Image src={qrCode} alt=\"2FA QR Code\" width={200} height={200} />\r\n                </div>\r\n                \r\n                <div className=\"space-y-4\">\r\n                  <div className=\"bg-yellow-50 p-3 rounded border border-yellow-200\">\r\n                    <p className=\"text-xs text-yellow-800 font-mono break-all\">\r\n                      SECRET: {secret}\r\n                    </p>\r\n                    <p className=\"text-xs text-yellow-600 mt-1\">\r\n                      (Forensic Artifact: This secret is stored in DB)\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-1\">Verify Code</label>\r\n                    <div className=\"flex gap-2\">\r\n                      <input \r\n                        type=\"text\" \r\n                        value={otp}\r\n                        onChange={(e) => setOtp(e.target.value)}\r\n                        className=\"p-2 border rounded w-32 text-center tracking-widest text-black\"\r\n                        placeholder=\"000 000\"\r\n                        maxLength={6}\r\n                      />\r\n                      <button \r\n                        onClick={verify2FA}\r\n                        className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\"\r\n                      >\r\n                        Verify\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {msg.includes('Successfully') && (\r\n            <div className=\"mt-4 p-4 bg-green-100 text-green-800 rounded\">\r\n              {msg}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}